---
title: "Jazz through the years"
author: "Jonas Schoonhoven"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(usethis)
library(spotifyr)
library(compmus)
library(plotly)
```

## Column {data-width="500"}

### Made Buble the genre more danceable? 

```{r scatterplot}
jazz <- get_playlist_audio_features("", "6W4qNJv2ViwlCElxMIK24H")
MB <- get_playlist_audio_features("", "37i9dQZF1DZ06evO0WqnZe")
FS <- get_playlist_audio_features("", "37i9dQZF1DZ06evO102dNu")
combined <- rbind(MB, FS)

scatter <- ggplot(combined, aes(x=valence, y=danceability, color=playlist_name)) +
  geom_point() +
  expand_limits(x=0, y=0) +
  labs(x="Valence", y="Danceability")

ggplotly(scatter) %>%
  layout(legend = list(x=0.7, y=0.1))
```

***

I have made a scatterplot with on the x axis all the valence values of the tracks that are present in the "This is Frank Sinatra" and "This is Micheal Buble" playlists. On the y axis i have plotted al the danceability values of the same tracks. For the color of the dots I have used the album of the artist who sang the song. This makes it clear which dot belongs to which artist. 

I think this plot is interesting because it is actually in line with what I thought about the artist before making the plot. In the plot it can be seen that Buble in general scores higher in the danceability scores than Sinatra. My thoughts about the bibliograhpy of Buble were that he has a lot covers from Sinatra and next to those covers he has more hip hop styled songs. I think that these thoughts are well represented in this plot.

### Same song, different interpretation [chroma features]

```{r DTW}
sinatra <-
  get_tidy_audio_analysis("7FXj7Qg3YorUxdrzvrcY25") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

buble <-
  get_tidy_audio_analysis("7rqSxhVpV4uSKI6WBuToC7") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

compmus_long_distance(
  sinatra |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  buble |> mutate(pitches = map(pitches, compmus_normalise, "chebyshev")),
  feature = pitches,
  method = "euclidean"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "Sinatra", y = "Buble", title = "'Fly me to the moon' by two artits") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_fill_viridis_c(guide = NULL)
```

***

I really tried to make this plot interactive but my computer would literally crash.

### Conclusion

```{r}

```
